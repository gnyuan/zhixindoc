日期函数
============

下面列出了所有知心插件中与日期相关的工具函数，每个函数均可直接在 Excel 中调用。本文档详细介绍每个函数的功能、调用语法、参数说明以及使用示例，帮助用户快速上手使用这些日期工具。

1 计算这天所在月份的天数 (zd_days_in_month)
---------------------------------------------
该函数用于计算指定日期所在月份的总天数。  
**Excel 调用语法：**

.. code-block:: none

    =zd_days_in_month(date)

**参数说明：**

- **date** (可选)：日期，可以为数字或字符串格式，默认值为“今天”。  
  支持的日期格式包括：  
  - 20240101  
  - 2024-01-01  
  - 2024/01/01  
  - 2024/1/1  
  - 2024-1-1

**返回值：**  
返回指定日期所在月份的天数（如 31）。

**使用示例：**

.. code-block:: none

    =zd_days_in_month("20250101")   // 返回 31
    =zd_days_in_month(2026/1/1)       // 返回 31


2 计算这天所在年份的天数 (zd_days_in_year)
--------------------------------------------
该函数用于计算指定日期所在年份的总天数。  
**Excel 调用语法：**

.. code-block:: none

    =zd_days_in_year(date)

**参数说明：**

- **date** (可选)：日期，支持多种格式，默认值为“今天”。

**返回值：**  
返回指定日期所在年份的天数（例如：365 或 366）。

**使用示例：**

.. code-block:: none

    =zd_days_in_year("20250101")   // 返回 365
    =zd_days_in_year(2020/1/1)       // 返回 366


3 计算这天是本周第几天 (zd_day_of_week)
----------------------------------------
该函数用于确定指定日期在本周中的顺序，周一返回 1，周日返回 7。  
**Excel 调用语法：**

.. code-block:: none

    =zd_day_of_week(date)

**参数说明：**

- **date** (可选)：日期，支持数字或字符串格式，默认值为“今天”。

**返回值：**  
返回一个数字，表示该日期在一周中的顺序（1 至 7）。

**使用示例：**

.. code-block:: none

    =zd_day_of_week("20250101")   // 返回 3
    =zd_day_of_week(2026/1/1)       // 返回 4


4 计算这天是本月的第几周 (zd_week_of_month)
--------------------------------------------
该函数用于计算指定日期在其所在月份中的周次。  
**Excel 调用语法：**

.. code-block:: none

    =zd_week_of_month(date)

**参数说明：**

- **date** (可选)：日期，支持多种格式，默认值为“今天”。

**返回值：**  
返回一个数字，表示该日期是本月的第几周。

**使用示例：**

.. code-block:: none

    =zd_week_of_month("20250101")   // 返回 1
    =zd_week_of_month(2026/1/1)       // 返回 1


5 计算这天是该年第几周 (zd_week_of_year)
------------------------------------------
该函数用于计算指定日期在其所在年份中的周次（可能为 53 或 54 周）。  
**注意：** 元旦或元旦之后几天可能属于上一年的最后一周，使用时请结合年份进行判断。  
**Excel 调用语法：**

.. code-block:: none

    =zd_week_of_year(date)

**参数说明：**

- **date** (可选)：日期，支持数字或字符串格式，默认值为“今天”。

**返回值：**  
返回一个数字，表示该日期是该年第几周。

**使用示例：**

.. code-block:: none

    =zd_week_of_year("20250101")   // 返回 1
    =zd_week_of_year(2026/1/1)       // 返回 53


6 计算这天是该年第几季 (zd_quarter_of_year)
--------------------------------------------
该函数用于确定指定日期所在的季度。  
**Excel 调用语法：**

.. code-block:: none

    =zd_quarter_of_year(date)

**参数说明：**

- **date** (可选)：日期，支持多种格式，默认值为“今天”。  
  例如：1 月 1 日至 3 月 31 日为第一季。

**返回值：**  
返回一个数字，表示该日期所在的季度（1 至 4）。

**使用示例：**

.. code-block:: none

    =zd_quarter_of_year("20250101")   // 返回 1
    =zd_quarter_of_year(2026/4/1)       // 返回 2


7 将 Unix 纪元时间戳转换为日期 (zd_EpochToDate)
--------------------------------------------------
该函数用于将 Unix 纪元时间戳（支持秒、毫秒或微秒）转换为 UTC 日期时间格式。  
**Excel 调用语法：**

.. code-block:: none

    =zd_EpochToDate(timestamp, [time_unit])

**参数说明：**

- **timestamp** (必需)：Unix 纪元时间戳，支持秒、毫秒或微秒。
- **time_unit** (可选，默认 1)：表示时间戳的单位  
  - 1：秒  
  - 2：毫秒  
  - 3：微秒

**返回值：**  
返回转换后的 UTC 日期时间字符串（格式如 "yyyy-mm-dd HH:MM:SS"）。

**使用示例：**

.. code-block:: none

    =zd_EpochToDate(1655906568893, 2)   // 返回 "2022-06-22 12:02:48"


8 计算两个日期之间的差值 (zd_DateDif)
----------------------------------------
该函数用于计算两个日期之间的差值，支持天、月、年等多种单位。  
**Excel 调用语法：**

.. code-block:: none

    =zd_DateDif(start_date, end_date, unit)

**参数说明：**

- **start_date** (必需)：开始日期，可以是 DATE 类型的单元格引用、函数返回值或数字。
- **end_date** (必需)：结束日期，同上。
- **unit** (必需)：时间单位缩写，例如：  
  - "Y"：年  
  - "M"：月  
  - "D"：天  
  - "MD"、"YM"、"YD"：用于更精细的日期差计算

**返回值：**  
返回两个日期之间的差值，单位由参数 unit 决定。

**使用示例：**

.. code-block:: none

    =zd_DateDif(DATE(1969, 7, 16), DATE(1969, 7, 24), "D")   // 返回 8
